{
  "definitions": {
    "task": {
      "type": "object",
      "properties": {
        "action": {
          "enum": [
            "DB_CASSANDRA_OPERATION"
          ]
        },
        "description": {
          "type": "string",
          "description": "Task description"
        },
        "operation": {
          "type": "string",
          "description": "Cassandra operation to execute"
        },
        "skip_tables": {
          "type": "array",
          "description": "Qualified table names to skip when truncating tables (keyspace.table).",
          "items": {
            "type": "string"
          }
        },
        "keyspace": {
          "type": "string",
          "description": "Optional keyspace override. Required for CQL operations; when provided for drop/truncate/list operations it restricts processing to the named keyspace."
        },
        "table": {
          "type": "string",
          "description": "Target table for LOAD_CSV operation."
        },
        "file_path": {
          "type": "string",
          "description": "Absolute or relative CSV file path for LOAD_CSV operation."
        },
        "columns": {
          "type": "array",
          "description": "Optional explicit column list. If omitted and has_header is true, columns are inferred from CSV header.",
          "items": {
            "type": "string"
          }
        },
        "delimiter": {
          "type": "string",
          "description": "Optional one-character CSV delimiter. Defaults to comma (,)."
        },
        "has_header": {
          "type": "boolean",
          "description": "Whether the CSV file includes a header row. Defaults to true."
        }
      },
      "allOf": [
        {
          "if": {
            "properties": {
              "action": {
                "const": "DB_CASSANDRA_OPERATION"
              }
            },
            "required": [
              "action"
            ]
          },
          "then": {
            "required": [
              "id",
              "action",
              "platform",
              "operation"
            ],
            "properties": {
              "operation": {
                "enum": [
                  "DROP_ALL_OBJECTS",
                  "TRUNCATE_ALL_TABLES",
                  "LIST_ALL_TABLES",
                  "LIST_ALL_OBJECTS",
                  "CHECK_CONNECTION",
                  "CQL",
                  "LOAD_CSV"
                ]
              }
            }
          }
        },
        {
          "if": {
            "properties": {
              "action": {
                "const": "DB_CASSANDRA_OPERATION"
              },
              "operation": {
                "const": "CQL"
              }
            },
            "required": [
              "action",
              "operation"
            ]
          },
          "then": {
            "required": [
              "keyspace",
              "command"
            ],
            "properties": {
              "command": {
                "type": "string",
                "description": "CQL statement to execute when operation is CQL."
              }
            }
          }
        },
        {
          "if": {
            "properties": {
              "action": {
                "const": "DB_CASSANDRA_OPERATION"
              },
              "operation": {
                "const": "LOAD_CSV"
              }
            },
            "required": [
              "action",
              "operation"
            ]
          },
          "then": {
            "required": [
              "keyspace",
              "table",
              "file_path"
            ]
          }
        }
      ]
    }
  }
}
